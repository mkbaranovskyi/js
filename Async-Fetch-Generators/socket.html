<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>WebSocket Chat</title>
</head>
<body>
	<form name="publish">
		<label for="msg">Enter your message: </label>
		<input type="text" name="msg" id="msg"><br>
		<button type="submit" id="sub">Submit</button>
	</form>

	<div id="messages"></div>

	<script>
		
		const socket = new WebSocket('wss://javascript.info/article/websocket/chat/ws')

		document.forms.publish.onsubmit = e => {
			// const data = new FormData(document.forms.publish)

			if(socket.readyState === 1){	// connection is open
				socket.send(msg.value)
			}
			
			return false
		}

		socket.onmessage = e => {
			console.log(e.data)

			const div = document.createElement('div')
			document.getElementById('messages').prepend(div)
			div.textContent = e.data
		}

	</script>
</body>
</html>